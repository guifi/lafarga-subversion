<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Linux/x86 (vers 1st August 2004), see www.w3.org">

  <title>Re-Index Hosts</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79">
  <link rel="HOME" title="The Cacti Manual" href="index.html">
  <link rel="UP" title="Command Line Scripts" href="scripts.html">
  <link rel="PREVIOUS" title="Command Line Scripts" href="scripts.html">
  <link rel="NEXT" title="Empty Poller Output Table" href="cli_poller_output_empty.html">
  <link rel="STYLESHEET" type="text/css" href="manual.css">
</head>

<body class="SECT1" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <th colspan="3" align="center">The Cacti Manual</th>
      </tr>

      <tr>
        <td width="10%" align="left" valign="bottom"><a href="scripts.html" accesskey="P">Prev</a></td>

        <td width="80%" align="center" valign="bottom">Chapter 20. Command Line Scripts</td>

        <td width="10%" align="right" valign="bottom"><a href="cli_poller_output_empty.html" accesskey="N">Next</a></td>
      </tr>
    </table>
    <hr align="left" width="100%">
  </div>

  <div class="SECT1">
    <h1 class="SECT1"><a name="CLI_POLLER_REINDEX_HOSTS" id="CLI_POLLER_REINDEX_HOSTS">Re-Index Hosts</a></h1>

    <p>Re-Indexing is required only for SNMP/Script Data Queries. Remember, that whan applying a Data Query to a Host, a <kbd class="USERINPUT">Re-Index Method</kbd> has to be chosen. This reindex method governs the automatic re-indexing based on specific events.</p>

    <div class="TABLE">
      <a name="AEN2802" id="AEN2802"></a>

      <p><b>Table 20-1. Re_Index Methods</b></p>

      <table border="1" frame="border" rules="all" class="CALSTABLE">
        <col width="1*">
        <col width="3*">

        <thead>
          <tr>
            <th align="center">Re-Index Method</th>

            <th align="center">Description</th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>Uptime Goes Backwards</td>

            <td>Refers to a system reboot. Cacti will detect if the target has been rebootet by querying sysUptime (.1.3.6.1.2.1.1.3.0). If the current value for the uptime is lower than the previous one (uptime goes backwards), a reboot is assumed and a re-index is performed</td>
          </tr>

          <tr>
            <td>Index Count Changed</td>

            <td>Refers to a change of the number of indexed items, e.g. interfaces, without checking sysUptime. It is of particular interest in cases, where indexed entries may change without the need of a reboot. As modern operating systems seldom require reboots for system configuration changes, you may want to consider this setting for many cases (e.g. creating of a new filesystem without a reboot). The index to be considered is defined by the according XML file.</td>
          </tr>

          <tr>
            <td>Verify All Fields</td>

            <td>All index fields of the according XML file are checked for changes. This is of particular interest e.g. in cases, where the index is non-numeric (e.g. a MAC address).</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p>If you feel the need for manual re-indexing, you may run it from cli. Calling the script with the parameter <kbd class="USERINPUT">--help</kbd> yields</p>
    <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp>php -q poller_reindex_hosts.php --help
Cacti Reindex Host Script 1.0, Copyright 2007 - The Cacti Group

usage: poller_reindex_hosts.php -id=[host_id|All] [-d] [-h] [--help] [-v] [--version]

-id=host_id   - The host_id to have data queries reindexed or 'All' to reindex all hosts
-d            - Display verbose output during execution
-v --version  - Display this help message
-h --help     - Display this help message
</pre>

    <p>Running it in debug mode for the host with <kbd class="USERINPUT">id=2</kbd> may yield</p>
    <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp>php -q poller_reindex_hosts.php -id=2 -d
WARNING: Do not interrupt this script.  Reindexing can take quite some time
DEBUG: There are '1' data queries to run
DEBUG: Data query number '1' starting
DEBUG: Data query number '1' ending
</pre>

    <p>A silent run for all devices is issued by</p>
    <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp>php -q poller_reindex_hosts.php -id=All
WARNING: Do not interrupt this script.  Reindexing can take quite some time
.....<samp class="PROMPT">shell&gt;</samp>
</pre>

    <div class="CAUTION">
      <table class="CAUTION" border="1" width="100%">
        <tr>
          <td align="center"><b>Stop the Poller during Re-Indexing</b></td>
        </tr>

        <tr>
          <td align="left">
            <p>Re-Indexing interferes with the poller operation. Please make sure, that the poller is not running and will not start during a reindex operation</p>
          </td>
        </tr>
      </table>
    </div>
  </div>

  <div class="NAVFOOTER">
    <hr align="left" width="100%">

    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td width="33%" align="left" valign="top"><a href="scripts.html" accesskey="P">Prev</a></td>

        <td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>

        <td width="33%" align="right" valign="top"><a href="cli_poller_output_empty.html" accesskey="N">Next</a></td>
      </tr>

      <tr>
        <td width="33%" align="left" valign="top">Command Line Scripts</td>

        <td width="34%" align="center" valign="top"><a href="scripts.html" accesskey="U">Up</a></td>

        <td width="33%" align="right" valign="top">Empty Poller Output Table</td>
      </tr>
    </table>
  </div>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Linux/x86 (vers 1st August 2004), see www.w3.org">

  <title>Upgrading Cacti</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79">
  <link rel="HOME" title="The Cacti Manual" href="index.html">
  <link rel="UP" title="Installation" href="installation.html">
  <link rel="PREVIOUS" title="Installing Under Windows" href="install_windows.html">
  <link rel="NEXT" title="Basics" href="basics.html">
  <link rel="STYLESHEET" type="text/css" href="manual.css">
</head>

<body class="CHAPTER" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <th colspan="3" align="center">The Cacti Manual</th>
      </tr>

      <tr>
        <td width="10%" align="left" valign="bottom"><a href="install_windows.html" accesskey="P">Prev</a></td>

        <td width="80%" align="center" valign="bottom"></td>

        <td width="10%" align="right" valign="bottom"><a href="basics.html" accesskey="N">Next</a></td>
      </tr>
    </table>
    <hr align="left" width="100%">
  </div>

  <div class="CHAPTER">
    <h1><a name="UPGRADE" id="UPGRADE"></a>Chapter 4. Upgrading Cacti</h1>

    <ol type="1">
      <li>
        <p>Backup the old Cacti database.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">mysqldump -l --add-drop-table cacti &gt; mysql.cacti</kbd>
</pre>

        <p>Note: You will probably have to specify the -u and -p flags for the MySQL username and password. This user must have permission to read from Cacti's database or you will end up with an empty backup.</p>
      </li>

      <li>
        <p>Backup the old Cacti directory.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">mv cacti cacti_old</kbd>
</pre>
      </li>

      <li>
        <p>Extract the distribution tarball.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">tar xzvf cacti-version.tar.gz</kbd>
</pre>
      </li>

      <li>
        <p>Rename the new Cacti directory to match the old one.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">mv cacti-version cacti</kbd>
</pre>
      </li>

      <li>
        <p>Edit <tt class="FILENAME">include/config.php</tt> and specify the MySQL user, password and database for your Cacti configuration.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">$database_type = "mysql";
$database_default = "cacti";
$database_hostname = "localhost";
$database_username = "cactiuser";
$database_password = "cacti";</kbd>
</pre>
      </li>

      <li>
        <p>Copy the *.rrd files from the old Cacti directory.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">cp cacti_old/rra/* cacti/rra/</kbd>
</pre>
      </li>

      <li>
        <p>Copy any relevant custom scripts from the old Cacti directory. Some script are updated between versions. Therefore, make sure you only over write if the scripts either don't exist or are newer than the distribution's.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">cp -u cacti_old/scripts/* cacti/scripts/</kbd>
</pre>
      </li>

      <li>
        <p>Copy any relevant custom resource XML files from the old Cacti directory. Some resource XML files are updated between versions. Therefore, make sure you only over write if the XML files either don't exist or are newer than the distribution's.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">cp -u -R cacti_old/resource/* cacti/resource/</kbd>
</pre>
      </li>

      <li>
        <p>Set the appropriate permissions on Cacti's directories for graph/log generation. You should execute these commands from inside Cacti's directory to change the permissions.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">chown -R cactiuser rra/ log/</kbd>
</pre>

        <p>(Enter a valid username for cactiuser, this user will also be used in the next step for data gathering.)</p>
      </li>

      <li>
        <p>Point your web browser to:</p><a name="AEN647" id="AEN647"></a>

        <blockquote class="BLOCKQUOTE">
          <p>http://your-server/cacti/</p>
        </blockquote>

        <p>Follow the on-screen instructions so your database can be updated to the new version.</p>
      </li>
    </ol>
  </div>

  <div class="NAVFOOTER">
    <hr align="left" width="100%">

    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td width="33%" align="left" valign="top"><a href="install_windows.html" accesskey="P">Prev</a></td>

        <td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>

        <td width="33%" align="right" valign="top"><a href="basics.html" accesskey="N">Next</a></td>
      </tr>

      <tr>
        <td width="33%" align="left" valign="top">Installing Under Windows</td>

        <td width="34%" align="center" valign="top"><a href="installation.html" accesskey="U">Up</a></td>

        <td width="33%" align="right" valign="top">Basics</td>
      </tr>
    </table>
  </div>
</body>
</html>

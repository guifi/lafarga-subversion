<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Linux/x86 (vers 1st August 2004), see www.w3.org">

  <title>How To</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79">
  <link rel="HOME" title="The Cacti Manual" href="index.html">
  <link rel="UP" title="Help" href="cacti_help.html">
  <link rel="PREVIOUS" title="Help" href="cacti_help.html">
  <link rel="NEXT" title="Frequently Asked Questions" href="faq.html">
  <link rel="STYLESHEET" type="text/css" href="manual.css">
</head>

<body class="CHAPTER" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <th colspan="3" align="center">The Cacti Manual</th>
      </tr>

      <tr>
        <td width="10%" align="left" valign="bottom"><a href="cacti_help.html" accesskey="P">Prev</a></td>

        <td width="80%" align="center" valign="bottom"></td>

        <td width="10%" align="right" valign="bottom"><a href="faq.html" accesskey="N">Next</a></td>
      </tr>
    </table>
    <hr align="left" width="100%">
  </div>

  <div class="CHAPTER">
    <h1><a name="HOW_TO" id="HOW_TO"></a>Chapter 16. How To</h1>

    <div class="SECT1">
      <h1 class="SECT1"><a name="SCRIPT_TO_GRAPH" id="SCRIPT_TO_GRAPH">Simplest Method of Going from Script to Graph (Walkthrough)</a></h1>

      <div class="AUTHORBLURB">
        <a name="AEN2074" id="AEN2074"></a>

        <p><b class="EMPHASIS">Written by Kevin der Kinderen, <a href="http://kdeuja.com/~kevin/" target="_top">http://kdeuja.com/~kevin/</a></b></p>
      </div>

      <p>This HOWTO walks you through the simplest steps of graphing the output of a single value from a script. As a new user of cacti, I had a difficult time understanding how to graph anything that wasn't canned with the original load. After a lot of playing around, I came up with these procedures which can be built upon for more sophisticated collections and graphs.</p>

      <p>I do not use templates in this HOWTO. Templates provide a significant advantage if you are graphing the output for multiple instances or creating graphs for multiple hosts. They help to maintain consistency and simplify setup.</p>

      <p>The example here is not realistic, but can be used and expanded upon as a model for creating your own graphs.</p>

      <p>I've not put a lot of explanations in the procedures. Refer to the Cacti manual for more details.</p>

      <p>Have a tested script ready to go. I used the following script located in <tt class="FILENAME">/home/cactiuser/bin</tt> called <tt class="FILENAME">random2.pl</tt>:</p>
      <pre class="PROGRAMLISTING">
#!/usr/bin/perl -w

print int(rand(10));
</pre>

      <p>This script simply prints out a random integer between 0 and 9 every time it's called.</p>

      <p><b>The minimal steps to create a graph from a script are simply:</b></p>

      <ol type="1">
        <li>
          <p>Create a Data Input Method to tell Cacti how to call the script and what to expect from it.</p>
        </li>

        <li>
          <p>Create a Data Source to tell cacti how and where the data will be stored.</p>
        </li>

        <li>
          <p>Create a Graph to tell cacti how the data will be presented in graph form.</p>
        </li>

        <li>
          <p>Add Graph to Graph View so you can view the graph.</p>
        </li>

        <li>
          <p>View the Graph</p>
        </li>
      </ol>

      <p><b>The details are below:</b></p>

      <ol type="1">
        <li>
          <p>Create Data Input Method</p>

          <ul>
            <li>
              <p>Click the <span class="GUILABEL">Console</span> tab at the top</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Data Input Methods</span> under <span class="GUILABEL">Management</span></p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Add</span></p>
            </li>

            <li>
              <p>Name: Random 2 Input</p>
            </li>

            <li>
              <p>Input Type: Script/Command</p>
            </li>

            <li>
              <p>Input String: /home/cactiuser/bin/random2.pl</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span></p>
            </li>

            <li>
              <p>Should see "Save Successful." at the top of the page.</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Add</span> by Output Fields (there are no input fields for this example)</p>
            </li>

            <li>
              <p>Field [Output]: random_number</p>
            </li>

            <li>
              <p>Friendly Name: Random Number</p>
            </li>

            <li>
              <p>Update RRD File: checked</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span></p>
            </li>

            <li>
              <p>Should see "Save Successful." and random_number listed under <span class="GUILABEL">Output Fields</span>.</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Save</span></p>
            </li>

            <li>
              <p>Should see "Save Successful." and Random Input listed in <span class="GUILABEL">Data Input Methods</span>.</p>
            </li>
          </ul>
        </li>

        <li>
          <p>Create a Data Source</p>

          <ul>
            <li>
              <p>Click <span class="GUILABEL">Data Sources</span> under <span class="GUILABEL">Management</span></p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Add</span> in the top right</p>
            </li>

            <li>
              <p>The <span class="GUILABEL">Data Template</span> Section should be None and None, we're not using templates for this example.</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span>.</p>
            </li>

            <li>
              <p>Name: random2ds</p>
            </li>

            <li>
              <p>Data Source Path: blank (Cacti will fill this in)</p>
            </li>

            <li>
              <p>Data Input Source: Random 2 Input (this is the data input method you created in step 1)</p>
            </li>

            <li>
              <p>Highlight each of the Associated RRA's using control-click</p>
            </li>

            <li>
              <p>Step: 300 (300 seconds = 5 minutes)</p>
            </li>

            <li>
              <p>Data Source Active: checked</p>
            </li>

            <li>
              <p>Describe the Data Source Item inside the RRA by...</p>
            </li>

            <li>
              <p>Internal Data Source Name: random_number</p>
            </li>

            <li>
              <p>Minimum Value: 0</p>
            </li>

            <li>
              <p>Maximum Value: 0</p>
            </li>

            <li>
              <p>Data Source Type: GAUGE</p>
            </li>

            <li>
              <p>Heartbeat: 600</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span></p>
            </li>

            <li>
              <p>Should see "Save Successful." at the top and the Data Source Path should now have a value (my example &lt;path_rra&gt;/random_number_286.rrd)</p>
            </li>

            <li>
              <p>Click Turn On Data Source Debugging Mode to see the results of this step.</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Save</span></p>
            </li>

            <li>
              <p>Should see "Save Successful" and your new Data Source listed.</p>
            </li>
          </ul>
        </li>

        <li>
          <p>Create Graph</p>

          <ul>
            <li>
              <p>Select <span class="GUILABEL">Graph Management</span> under <span class="GUILABEL">Management</span></p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Add</span></p>
            </li>

            <li>
              <p>Selected Graph Template: None</p>
            </li>

            <li>
              <p>Host: None</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span></p>
            </li>

            <li>
              <p>Title: RANDOM NUMBERS</p>
            </li>

            <li>
              <p>Image Format: PNG</p>
            </li>

            <li>
              <p>Height: 120</p>
            </li>

            <li>
              <p>Width: 500</p>
            </li>

            <li>
              <p>Auto Scale: checked</p>
            </li>

            <li>
              <p>Auto Scale Options: Use --alt-autoscale-max</p>
            </li>

            <li>
              <p>Logarithmic Scaling: unchecked</p>
            </li>

            <li>
              <p>Rigid Boundaries: unchecked</p>
            </li>

            <li>
              <p>Auto Padding: checked</p>
            </li>

            <li>
              <p>Allow Graph Export: checked</p>
            </li>

            <li>
              <p>Upper Limit: 100</p>
            </li>

            <li>
              <p>Lower Limit: 0</p>
            </li>

            <li>
              <p>Base Value: 1000</p>
            </li>

            <li>
              <p>Unit Value: blank</p>
            </li>

            <li>
              <p>Unit Exponent Value: 0</p>
            </li>

            <li>
              <p>Vertical Label: Random Number</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span></p>
            </li>

            <li>
              <p>Should see "Save Successful."</p>
            </li>

            <li>
              <p>If you click "Turn On Graph Debug Mode." now you will see: "Error: can't make a graph without contents." We need to add Graph Items:</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Add</span> by <span class="GUILABEL">Graph Items</span></p>
            </li>

            <li>
              <p>Data Source: (from list) No Host - random2ds (random_number)</p>
            </li>

            <li>
              <p>Color: 0000FF (Blue)</p>
            </li>

            <li>
              <p>Graph Item Type: LINE2</p>
            </li>

            <li>
              <p>Consolidation Function: AVERAGE</p>
            </li>

            <li>
              <p>CDEF Function: None</p>
            </li>

            <li>
              <p>Value: blank</p>
            </li>

            <li>
              <p>GPRINT Type: Normal</p>
            </li>

            <li>
              <p>Text Format: blank</p>
            </li>

            <li>
              <p>Insert Hard Return: unchecked</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span></p>
            </li>

            <li>
              <p>Should see "Save Successful.", Item #1 listed and a graph under debug (probably with nothing in it yet)</p>
            </li>

            <li>
              <p>To add a legend, click <span class="GUILABEL">Add</span> by <span class="GUILABEL">Graph Items</span> again</p>
            </li>

            <li>
              <p>Data Source: No Host - random2ds (random_number)</p>
            </li>

            <li>
              <p>Color: None</p>
            </li>

            <li>
              <p>Graph Item Type: GPRINT</p>
            </li>

            <li>
              <p>Consolidation Function: LAST</p>
            </li>

            <li>
              <p>CDEF Function: None</p>
            </li>

            <li>
              <p>Value: blank</p>
            </li>

            <li>
              <p>GPRINT Type: Normal</p>
            </li>

            <li>
              <p>Text Format: Cur:</p>
            </li>

            <li>
              <p>Insert Hard Return: unchecked</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span></p>
            </li>

            <li>
              <p>Should see "Save Successful." and the graph will have a legend showing the current value. Note: your integer random number has been averaged over the past 5 minutes. At the bottom of the page, click save.</p>
            </li>

            <li>
              <p>At the bottom of the page, click <span class="GUILABEL">Save</span>.</p>
            </li>

            <li>
              <p>Should see "Save Successful." and your graph listed.</p>
            </li>
          </ul>
        </li>

        <li>
          <p>Add graph to the graph view</p>

          <ul>
            <li>
              <p>Click <span class="GUILABEL">Graph Trees</span> under <span class="GUILABEL">Management</span></p>
            </li>

            <li>
              <p>We'll create a tree called "test" to place our graph</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Add</span></p>
            </li>

            <li>
              <p>Name: test</p>
            </li>

            <li>
              <p>Should see "Save Successful"</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Add</span> beside <span class="GUILABEL">Tree Items</span> (to add our graph to this tree)</p>
            </li>

            <li>
              <p>Under Tree Items [graph]...</p>
            </li>

            <li>
              <p>Graph: RANDOM NUMBERS (we named this in step 3)</p>
            </li>

            <li>
              <p>Round Robin Archive: Daily (5 Minute Average)</p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Create</span></p>
            </li>

            <li>
              <p>Should see "Save Successful." and RANDOM NUMBERS listed under <span class="GUILABEL">Tree Items</span></p>
            </li>

            <li>
              <p>Click <span class="GUILABEL">Save</span></p>
            </li>

            <li>
              <p>Should see "Save Successful." and test listed under <span class="GUILABEL">Graph Trees</span></p>
            </li>
          </ul>
        </li>

        <li>
          <p>View Graph</p>

          <ul>
            <li>
              <p>Select <span class="GUILABEL">Graphs</span> tab</p>
            </li>

            <li>
              <p>Select tree view (Tree beside settings tab)</p>
            </li>

            <li>
              <p>Select test tree on left</p>
            </li>

            <li>
              <p>You may see "Random Graph" but no graph. It takes two or three polls (10 - 15 minutes) to see a graph. I believe poll 1 to create the rrd, poll 2 to get the first data point and poll 3 to have graphable points.</p>
            </li>

            <li>
              <p>While waiting, you can click the RANDOM NUMBERS graph. You'll see place holders for 4 graphs. Select [source] under Daily (5 Minute Average). You'll see the source for the call to rrdtool graph. Give it a sanity check.</p>
            </li>

            <li>
              <p>Now be patient. Hit your refresh button every few minutes. After the first poll I got a few empty graphs. A few minutes later data started showing up.</p>
            </li>
          </ul>
        </li>
      </ol>
    </div>
  </div>

  <div class="NAVFOOTER">
    <hr align="left" width="100%">

    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td width="33%" align="left" valign="top"><a href="cacti_help.html" accesskey="P">Prev</a></td>

        <td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>

        <td width="33%" align="right" valign="top"><a href="faq.html" accesskey="N">Next</a></td>
      </tr>

      <tr>
        <td width="33%" align="left" valign="top">Help</td>

        <td width="34%" align="center" valign="top"><a href="cacti_help.html" accesskey="U">Up</a></td>

        <td width="33%" align="right" valign="top">Frequently Asked Questions</td>
      </tr>
    </table>
  </div>
</body>
</html>

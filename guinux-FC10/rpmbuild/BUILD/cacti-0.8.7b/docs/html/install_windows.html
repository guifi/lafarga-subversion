<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Linux/x86 (vers 1st August 2004), see www.w3.org">

  <title>Installing Under Windows</title>
  <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79">
  <link rel="HOME" title="The Cacti Manual" href="index.html">
  <link rel="UP" title="Installation" href="installation.html">
  <link rel="PREVIOUS" title="Apply Patches" href="unix_apply_patches.html">
  <link rel="NEXT" title="Upgrading Cacti" href="upgrade.html">
  <link rel="STYLESHEET" type="text/css" href="manual.css">
</head>

<body class="CHAPTER" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="NAVHEADER">
    <table summary="Header navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <th colspan="3" align="center">The Cacti Manual</th>
      </tr>

      <tr>
        <td width="10%" align="left" valign="bottom"><a href="unix_apply_patches.html" accesskey="P">Prev</a></td>

        <td width="80%" align="center" valign="bottom"></td>

        <td width="10%" align="right" valign="bottom"><a href="upgrade.html" accesskey="N">Next</a></td>
      </tr>
    </table>
    <hr align="left" width="100%">
  </div>

  <div class="CHAPTER">
    <h1><a name="INSTALL_WINDOWS" id="INSTALL_WINDOWS"></a>Chapter 3. Installing Under Windows</h1>

    <p><b>Software Components Required</b></p>

    <ol type="1">
      <li>
        <p>(Optional) Apache&gt; - This software is optional if running Windows Internet Information Server.</p>
      </li>

      <li>
        <p>Cacti&gt; - Install from the zip distribution and install in the web root or your choice. Many choose to install into a "Cacti" sub folder.</p>
      </li>

      <li>
        <p>Spine - Install from the zip distribution into the <tt class="FILENAME">c:\cacti</tt> directory. Make sure your <tt class="FILENAME">spine.conf.dist</tt> is located in that directory as well.</p>
      </li>

      <li>
        <p>RRDTool - Install from the Cacti website. Install it into the <tt class="FILENAME">c:\cacti</tt> directory.</p>
      </li>

      <li>
        <p>PHP 4.3.6+ or 5.x - Install into the <tt class="FILENAME">c:\php</tt> folder. If you choose to install into <tt class="FILENAME">c:\Program Files\php</tt>, you will have to use 8.3 filenames to reference it's binaries in Cacti.</p>
      </li>

      <li>
        <p>MySQL 4.x or MySQL 5.x - Install into the default location. This is typically <tt class="FILENAME">c:\Program Files\MySQL\MySQL Server X.XX</tt>.</p>
      </li>

      <li>
        <p>(Optional) Cygwin - Download and execute <tt class="FILENAME">setup.exe</tt> from the Cygwin website. Keep the <tt class="FILENAME">setup.exe</tt> file for later use.</p>
      </li>

      <li>
        <p>(Optional) Net-SNMP - Install to the <tt class="FILENAME">c:\net-snmp</tt> directory. If you choose to use <tt class="FILENAME">c:\Program Files\net-snmp</tt> you will have tu use 8.3 filenames to reference it's binaries in Cacti.</p>
      </li>
    </ol>

    <p><b>Configure PHP</b></p>

    <ol type="1">
      <li>
        <p>If using PHP 4, move the files in <tt class="FILENAME">c:\php\dlls</tt> to <tt class="FILENAME">c:\php</tt></p>
      </li>

      <li>
        <p>Add the following directory to the existing Windows System <kbd class="USERINPUT">PATH</kbd> environment variable: <tt class="FILENAME">c:\php</tt>. The Windows path can be accessed via the Control Panel at: System | Advanced | Environment Variables | System Variables.</p>
      </li>

      <li>
        <p>Add the following directory to a new Windows System environment variable called <kbd class="USERINPUT">PHPRC</kbd>: <tt class="FILENAME">c:\php</tt>.</p>
      </li>

      <li>
        <p>Add a new Windows System environment variable called <kbd class="USERINPUT">MIBDIRS</kbd>. If using PHP 4, set it to <tt class="FILENAME">c:\php\mibs</tt>. If using PHP 5, set it to <tt class="FILENAME">c:\php\extras\mibs</tt></p>
      </li>

      <li>
        <p>If using PHP 4.3.5 or less, create the following directory <tt class="FILENAME">c:\tmp</tt>.</p>
      </li>

      <li>
        <p>Rename the file <tt class="FILENAME">c:\php\php.ini.dist</tt> to <tt class="FILENAME">php.ini</tt>, and make the following changes to it:</p>

        <p>If using PHP 4 add/uncomment the following lines.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">extension_dir = c:\php\extensions
extension=php_snmp.dll
extension=php_sockets.dll
cgi.force_redirect = 0</kbd>
</pre>

        <p>If using PHP 5 uncomment the following lines.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">extension_dir = c:\php\ext
extension=php_mysql.dll
extension=php_snmp.dll
extension=php_sockets.dll
cgi.force_redirect = 0</kbd>
</pre>

        <p>If using PHP 4.3.5 or less include the following line. If using 4.3.6 or greater, you should remove this line if present.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">session.save_path=c:\tmp</kbd>
</pre>
      </li>

      <li>
        <p>In earlier installation guides to PHP, they recommended moving certain DLL's to the <tt class="FILENAME">c:\winnt\system32</tt> directory. If so, you will have to remove those files. Please review the PHP installation documentation for instructions on removing those files.</p>
      </li>

      <li>
        <p>If you want to allow template importing, uncomment the following line:</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">file_uploads = On</kbd>
</pre>
      </li>

      <li>
        <p>Give the user who will be running the scheduled task, modify rights to the <tt class="FILENAME">.index</tt> file in the location pointed to by the <kbd class="USERINPUT">MIBDIRS</kbd> Windows System environment variable.</p>
      </li>
    </ol>

    <p><b>Configure the Webserver (Apache)</b></p>

    <ol type="1">
      <li>
        <p>Make sure you have stopped any IIS web servers before you proceed with Apache installation, or make sure Apache is configured on an alternate port.</p>
      </li>

      <li>
        <p>If you are using <b class="EMPHASIS">Apache 1.3.x</b>, installation of PHP 5 is not recommended. If using PHP 4, add the following lines to your <tt class="FILENAME">httpd.conf</tt> file. You can edit that file by selecting Start | All Programs | Apache HTTP Server X.XX | Configure Server | Edit the httpd.conf file pick from the Taskbar.</p>

        <p>If using Apache 1.3.x and PHP 4, then add the following lines:</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">LoadModule php4_module c:\php\sapi\php4apache.dll
AddModule mod_php4.c
AddType application/x-httpd-php .php
DirectoryIndex index.html index.htm index.php</kbd>
</pre>

        <p>If using Apache 2.x and PHP 4, then add the following lines:</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">LoadModule php4_module c:\php\sapi\php4apache2.dll
AddType application/x-httpd-php .php
DirectoryIndex index.html index.htm index.php</kbd>
</pre>

        <p>If using Apache 2.x and PHP 5, then add the following lines.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">LoadModule php5_module c:\php\php5apache2.dll
AddType application/x-httpd-php .php
DirectoryIndex index.html index.htm index.php</kbd>
</pre>
      </li>
    </ol>

    <p><b>Configure the Webserver (IIS)</b></p>

    <ol type="1">
      <li>
        <p>Start the Internet Information Services (IIS) Manager, right click on the <span class="GUILABEL">Default Web Site</span> (in most cases) and select <span class="GUILABEL">Properties</span>.</p>
      </li>

      <li>
        <p>Under the <span class="GUILABEL">Home Directory</span> tab, select <span class="GUILABEL">Configuration</span> and click <span class="GUILABEL">Add</span>. Browse to the path of <tt class="FILENAME">php4isapi.dll</tt> or <tt class="FILENAME">php5isapi.dll</tt>, and type in .php as the extension. Note: if using IIS6, Enable All Verbs and Script Engine.</p>
      </li>

      <li>
        <p>Under the <span class="GUILABEL">ISAPI Filters</span> tab, click <span class="GUILABEL">Add</span> and browse to the <tt class="FILENAME">php4isapi.dll</tt> or <tt class="FILENAME">php5isapi.dll</tt> file. Name the filter "php" and click OK.</p>
      </li>

      <li>
        <p>Under the <span class="GUILABEL">Documents</span> tab, add <tt class="FILENAME">index.php</tt> to the list.</p>
      </li>

      <li>
        <p>If using IIS6, goto <span class="GUILABEL">Web Service Extensions</span> and add a new Web Service Extension. Name the extension "php", and click <span class="GUILABEL">Add</span> and browse to the <tt class="FILENAME">php4isapi.dll</tt> or <tt class="FILENAME">php5isapi.dll</tt> file, enable <span class="GUILABEL">Set Extension</span> status to Enable, and click OK.</p>
      </li>

      <li>
        <p>Give the IUSR_XXXX and IIS_WPG users read &amp; execute permissions to the file <tt class="FILENAME">%windir%\system32\cmd.exe</tt>. They will also need read permissions on <tt class="FILENAME">cacti_web_root/cacti</tt> and it's subfolders.</p>
      </li>

      <li>
        <p>If using IIS6, give the IIS_WPG user modify permissions to the folders <tt class="FILENAME">cacti_web_root/cacti/log</tt> and <tt class="FILENAME">cacti_web_root/cacti/rrd</tt>.</p>
      </li>

      <li>
        <p>Completely stop and start the IIS service using the following commands:</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">net stop iisadmin
net start w3svc</kbd>
</pre>
      </li>
    </ol>

    <p><b>Install Cygwin (optional)</b></p>

    <ol type="1">
      <li>
        <p>Installing a single instance of Cygwin, and using it for all applications that require it is recommended so you do not have different versions of the Cygwin dlls laying around on your system, which can cause conflicts.</p>
      </li>

      <li>
        <p>Run <tt class="FILENAME">setup.exe</tt> you previously download.</p>
      </li>

      <li>
        <p>Once you reach the portion of setup entitled Select Packages, install the following:</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">Base (include all items)
Libs
        libart_lgpl
        libfreetype26
        libpng12
        zlib
        openssl
Utils
        patch
Web
        wget</kbd>
</pre>
      </li>

      <li>
        <p>Add <tt class="FILENAME">c:\cygwin\bin</tt> to your Windows System PATH environment variable.</p>
      </li>

      <li>
        <p>Move <tt class="FILENAME">setup.exe</tt> to <tt class="FILENAME">c:\cygwin</tt> for future use.</p>
      </li>
    </ol>

    <p><b>Install RRDTool</b></p>

    <ol type="1">
      <li>
        <p>Extract the RRDTool zip file from the Cacti web site to <tt class="FILENAME">c:\cacti\rrdtool.exe</tt>.</p>
      </li>
    </ol>

    <p><b>Install MySQL</b></p>

    <ol type="1">
      <li>
        <p>Extract the MySQL zip file to a temp directory and run <tt class="FILENAME">setup.exe</tt>.</p>
      </li>

      <li>
        <p>Install MySQL to the default directory, or for the purposes of this manual to the <tt class="FILENAME">c:\mysql</tt> directory.</p>
      </li>

      <li>
        <p>If running an older version of MySQL, start it by running <tt class="FILENAME">c:\mysql\bin\winmysqladmin.exe</tt>. In more recent versions, this is not required.</p>
      </li>

      <li>
        <p>Set a password for the root user</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">cd mysql\bin</kbd>
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">mysqladmin --user=root password somepassword</kbd>
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">mysqladmin --user=root --password reload</kbd>
</pre>
      </li>

      <li>
        <p>Create the MySQL database:</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">mysqladmin --user=root --password create cacti</kbd>
</pre>
      </li>

      <li>
        <p>Import the default Cacti database:</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">mysql --user=root --password cacti &lt; c:\apache2\htdocs\cacti\cacti.sql</kbd>
</pre>
      </li>

      <li>
        <p>Create a MySQL username and password for Cacti.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">mysql --user=root --password mysql</kbd>
<samp class="PROMPT">mysql&gt;</samp> <kbd class="USERINPUT">GRANT ALL ON cacti.* TO cactiuser@localhost IDENTIFIED BY 'somepassword';</kbd>
<samp class="PROMPT">mysql&gt;</samp> <kbd class="USERINPUT">flush privileges;</kbd>
</pre>
      </li>

      <li>
        <p>If you are running MySQl 4.1 and above, you will need to apply the old password setting in order to authenticate with Cacti. To make this change, stop the MySQL service and add the following to the Start Parameter field. Start it again once it has been added.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">--old-password</kbd>
</pre>

        <p>You will also need to update the cactiuser account with the old password style.</p>
        <pre class="SCREEN">
<samp class="PROMPT">shell&gt;</samp> <kbd class="USERINPUT">UPDATE mysql.user SET Password = OLD_PASSWORD('cactipwd')
                                WHERE Host = 'localhost' AND User = 'cactiuser';</kbd>
<samp class="PROMPT">mysql&gt;</samp> <kbd class="USERINPUT">FLUSH PRIVILEGES;</kbd>
</pre>
      </li>
    </ol>

    <p><b>Install Net-SNMP</b></p>

    <ol type="1">
      <li>
        <p>If you plan to use any hosts with SNMP v2c support, and are using early versions of PHP, you must download and install the <span class="APPLICATION">Net-SNMP</span> libraries. <span class="APPLICATION">Net-SNMP</span> provides installers to install their product. However, caution must be taken if you choose to use long file names as Cacti does not them as long file names. You will have to user 8.3 notation. For example <tt class="FILENAME">c:\Program Files\Net-SNMP\bin</tt> becomes <tt class="FILENAME">c:\progra~1\net-snmp\bin</tt>.</p>
      </li>
    </ol>

    <p><b>Install <span class="APPLICATION">Spine</span></b></p>

    <ol type="1">
      <li>
        <p>Extract the <span class="APPLICATION">Spine</span> zip file to <tt class="FILENAME">c:\cacti</tt> and modify the <tt class="FILENAME">spine.conf.dist</tt> file to include the following statements.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">DB_Host        127.0.0.1 or hostname (not localhost)
DB_Database     cacti
DB_User         cactiuser
DB_Password     cacti
DB_Port         3306</kbd>
</pre>

        <p>All other pre 0.8.6 settings are obsolete.</p>
      </li>

      <li>
        <p><span class="APPLICATION">Spine</span> now comes with a binary distribution. However, we strongly suggest that you install Cygwin and then remove all the DLL files and <tt class="FILENAME">sh.exe</tt> from the <tt class="FILENAME">c:\cacti</tt> directory.</p>
      </li>
    </ol>

    <p><b>Configure Cacti</b></p>

    <ol type="1">
      <li>
        <p>Edit <tt class="FILENAME">cacti_web_root/cacti/include/config.php</tt> and specify the MySQL user, password, database, and database port for your Cacti configuration.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">$database_default = "cacti";
$database_hostname = "localhost";
$database_username = "cactiuser";
$database_password = "cacti";
$database_port = "3306";</kbd>
</pre>
      </li>

      <li>
        <p>Point your web browser to:</p>
        <pre class="SCREEN">
http://your-server/cacti/
</pre>

        <p>Log in using the username and password of admin/admin. You will be required to change this password immediately.</p>
      </li>

      <li>
        <p>From Cacti, go to <span class="GUILABEL">Settings</span>-&gt;<span class="GUILABEL">Paths</span> and verify/udate your paths to point to the correct locations. Recommended examples are posted below. If you plan on using <span class="APPLICATION">Spine</span>, then it is very important that all paths include forward slashes instead of backslashes.</p>

        <p><b class="EMPHASIS">PHP Binary Path:</b></p>
        <pre class="SCREEN">
c:/php/php.exe
</pre>

        <p><b class="EMPHASIS">RRDTool Binary Path:</b></p>
        <pre class="SCREEN">
c:/cacti/rrdtool.exe
</pre>

        <p><b class="EMPHASIS">SNMPGET, SNMPWALK, SNMPBULKWALK, SNMPGETNEXT Paths:</b></p>
        <pre class="SCREEN">
c:/progra~1/net-snmp/bin/snmpget.exe
</pre>
        <pre class="SCREEN">
c:/progra~1/net-snmp/bin/snmpwalk.exe
</pre>
        <pre class="SCREEN">
c:/progra~1/net-snmp/bin/snmpbulkwalk.exe
</pre>
        <pre class="SCREEN">
c:/progra~1/net-snmp/bin/snmpgetnext.exe
</pre>

        <p><b class="EMPHASIS">Cacti Logfile Path:</b></p>
        <pre class="SCREEN">
c:/mycacti/website/cacti/log/cacti.log
</pre>

        <p><b class="EMPHASIS"><span class="APPLICATION">Spine</span> Path:</b></p>
        <pre class="SCREEN">
c:/cacti/<span class="APPLICATION">Spine</span>.exe
</pre>
      </li>

      <li>
        <p>Click on Devices. Delete the Localhost devices as it intended for Linux environments In the upper right corner, click Add. Fill in the following information and then click Add.</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">Description: My Windows localhost
Hostname: localhost
Host Template: Windows 2000/XP</kbd>
</pre>
      </li>

      <li>
        <p>You should now be looking at the localhost device screen. Right under it's name, there should be some SNMP information listed, if not you should double check the SNMP settings on the server and firewall settings. In the upper right-hand corner, click on Create Graphs for this Host. On the following screen, select a disk partition and network interface. At the bottom of the page, click on Create.</p>
      </li>

      <li>
        <p>Log into the user account you'll be using for the scheduled task and verify starting a Cacti polling cycle works. Do this by running the following from the command prompt:</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">php c:/cacti_web_root/cacti/poller.php</kbd>
</pre>

        <p>The output should look something like the following:</p>
        <pre class="SCREEN">
<kbd class="USERINPUT">C:\&gt;php c:\inetpub\wwwroot\cacti\poller.php
OK u:0.00 s:0.06 r:1.32
OK u:0.00 s:0.06 r:1.32
OK u:0.00 s:0.16 r:2.59
OK u:0.00 s:0.17 r:2.62
10/28/2005 04:57:12 PM - SYSTEM STATS: Time:4.7272 Method:cmd.php Processes:1 Threads:N/A Hosts:1 HostsPerProcess:2 DataSources:4 RRDsProcessed:2</kbd>
</pre>

        <p>After this has ran once, you should have <tt class="FILENAME">cacti.log</tt> in <tt class="FILENAME">/cacti/log/</tt> and rrd files in /cacti/rra/.</p>
      </li>

      <li>
        <p>You are going to need to schedule a task while logged on as an Administrator. This task is required to you can run <tt class="FILENAME">poller.php</tt> every 5 minutes. Make sure the Task Scheduler service is started and follow the steps below to begin.</p>

        <p><b class="EMPHASIS">Note:</b> The following instructions are based on Windows XP and Windows Server 2003. You should be able to follow these instructions close enough for Windows 2000 as well.</p>

        <ol type="a">
          <li>
            <p>Select <span class="GUILABEL">Start</span> --&gt; <span class="GUILABEL">Settings</span> --&gt; <span class="GUILABEL">Control Panel</span> and double click on <span class="GUILABEL">Scheduled Tasks</span>.</p>
          </li>

          <li>
            <p>Double click on <span class="GUILABEL">Add Scheduled Task</span>.</p>
          </li>

          <li>
            <p>Click <span class="GUILABEL">Next</span> and <span class="GUILABEL">Browse</span> on the following screen. Find <tt class="FILENAME">c:\php</tt> and select <tt class="FILENAME">php.exe</tt>. Choose <span class="GUILABEL">Daily</span> on and click <span class="GUILABEL">Next</span>.</p>
          </li>

          <li>
            <p>Click <span class="GUILABEL">Next</span> again without changing the time or date settings.</p>
          </li>

          <li>
            <p>When entering a username and password make sure the user has read and write access to the following directories:</p>
            <pre class="SCREEN">
<kbd class="USERINPUT">cacti_web_root/cacti/rra
cacti_web_root/log</kbd>
</pre>

            <p>Make sure the user has read, write, and execute access to the following directories:</p>
            <pre class="SCREEN">
<kbd class="USERINPUT">c:\php
c:\php\sapi</kbd>
</pre>
          </li>

          <li>
            <p>Click <span class="GUILABEL">Next</span> and <span class="GUILABEL">Finish</span> to close the wizard.</p>
          </li>

          <li>
            <p>Right click on the task you just created, and select <span class="GUILABEL">Properties</span>.</p>
          </li>

          <li>
            <p>Select the <span class="GUILABEL">Schedule</span> tab.</p>
          </li>

          <li>
            <p>Make sure <span class="GUILABEL">Daily</span> is selected and click the <span class="GUILABEL">Advanced</span> button.</p>
          </li>

          <li>
            <p>Check the <span class="GUILABEL">Repeat</span> checkbox, set it for 5 minutes and set the duration for 24 hours.</p>
          </li>

          <li>
            <p>Click <span class="GUILABEL">Ok</span></p>
          </li>

          <li>
            <p>In the <span class="GUILABEL">Run</span> textbox enter the following text making sure to use the appropriate paths.</p>
            <pre class="SCREEN">
c:\php\php.exe c:\mycacti\website\cacti\poller.php
</pre>

            <p>The start in box should say <tt class="FILENAME">c:\mycacti\website\cacti</tt>.</p>
          </li>
        </ol>
      </li>
    </ol>

    <p><b>Apply Patches</b></p>

    <ol type="1">
      <li>
        <p>There are two methods of applying patches to Cacti:</p>

        <ol type="a">
          <li>
            <p>If you have Cygwin installed, then the patch instructions which use wget and patch, will work.</p>
          </li>

          <li>
            <p>The other method requires you to visit http://www.cacti.net/downloads/patches/0.8.6h/pre-patched/ and manually download and replace the patched files.</p>
          </li>
        </ol>
      </li>

      <li>
        <p>You might need to reapply file/folder security on the files patched. Double check they are correct.</p>
      </li>
    </ol>
  </div>

  <div class="NAVFOOTER">
    <hr align="left" width="100%">

    <table summary="Footer navigation table" width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td width="33%" align="left" valign="top"><a href="unix_apply_patches.html" accesskey="P">Prev</a></td>

        <td width="34%" align="center" valign="top"><a href="index.html" accesskey="H">Home</a></td>

        <td width="33%" align="right" valign="top"><a href="upgrade.html" accesskey="N">Next</a></td>
      </tr>

      <tr>
        <td width="33%" align="left" valign="top">Apply Patches</td>

        <td width="34%" align="center" valign="top"><a href="installation.html" accesskey="U">Up</a></td>

        <td width="33%" align="right" valign="top">Upgrading Cacti</td>
      </tr>
    </table>
  </div>
</body>
</html>
